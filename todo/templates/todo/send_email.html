<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Send Email</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">

<div class="container my-5">
    <div class="row justify-content-center">
        <div class="col-md-6">

            <div class="card shadow-sm">
                <div class="card-header bg-primary text-white">
                    <h5 class="mb-0">Send an Email</h5>
                </div>
                <div class="card-body">
                    <form id="emailForm" method="post">
                        {% csrf_token %}
                        <div class="mb-3">
                            <label for="recipient" class="form-label">Recipient Email</label>
                            <input type="email" id="recipient" name="recipient" class="form-control" placeholder="example@gmail.com" required>
                        </div>

                        <div class="mb-3">
                            <label for="subject" class="form-label">Subject</label>
                            <input type="text" id="subject" name="subject" class="form-control" placeholder="Enter subject" required>
                        </div>

                        <div class="mb-3">
                            <label for="message" class="form-label">Message</label>
                            <textarea id="message" name="message" rows="4" class="form-control" placeholder="Write your message..." required></textarea>
                        </div>

                        <button type="submit" class="btn btn-success w-100">Send Email</button>
                    </form>
                </div>
            </div>

            <!-- Response Alert -->
            <div id="responseMessage" class="mt-3"></div>

        </div>
    </div>
</div>

<script>
document.getElementById("emailForm").addEventListener("submit", function(e) {
    e.preventDefault();

    let formData = new FormData(this);

    fetch("{% url 'send_email' %}", {
        method: "POST",
        body: formData,
        headers: {
            "X-CSRFToken": document.querySelector("[name=csrfmiddlewaretoken]").value
        }
    })
    .then(response => response.json())
    .then(data => {
        let responseDiv = document.getElementById("responseMessage");
        if (data.success) {
            responseDiv.innerHTML = `<div class="alert alert-success">${data.success}</div>`;
            document.getElementById("emailForm").reset();
        } else {
            responseDiv.innerHTML = `<div class="alert alert-danger">${data.error}</div>`;
        }
    })
    .catch(error => {
        document.getElementById("responseMessage").innerHTML =
            `<div class="alert alert-danger">Something went wrong: ${error}</div>`;
    });
});
</script>

</body>
</html>
